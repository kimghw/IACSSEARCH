아래는 Qdrant 벡터 DB와 이메일 메타데이터(제목 프리픽스, 보낸사람, 수신일시 등)를 활용해 “의장-멤버 코레스토런스” 프로세스를 모니터링하고 자동화하기 위한 핵심 유즈 케이스(UC)입니다.
각 유즈 케이스는 국제표준 서식(Actor, Goal, Pre/Post-conditions, Main Flow, Extensions)으로 간략 정리했습니다.
### UC-1. Qdrant 벡터 검색 서비스

| 항목       | 내용                                                                                                  |
| -------- | --------------------------------------------------------------------------------------------------- |
| **목적**   | 사용자가 자연어 질의를 하면 임베딩 변환 후 Qdrant 서버에서 유사 문서를 검색하여 결과를 반환한다.                       |
| **주 액터** | Search Service, User                                                                               |
| **사전조건** | Qdrant 서버 구동, 이메일 데이터 임베딩 및 인덱싱 완료, OpenAI API 연결 가능                                    |
| **주 흐름** | 1) 사용자 질의 수신 → 2) 질의 텍스트 임베딩 변환 → 3) Qdrant에서 유사도 검색 → 4) 메타데이터와 함께 결과 반환 → 5) 검색 로그 기록 |
| **사후조건** | 검색 결과가 사용자에게 전달되고, 검색 이력이 저장됨                                                                |
| **확장**   | 3-e) 검색 결과 없음 → "관련 문서를 찾을 수 없습니다" 메시지 반환<br>4-e) API 오류 → 재시도 후 실패 시 에러 메시지 반환 |


### UC-2. 주제(Topic) 식별 및 스레드 등록

| 항목       | 내용                                                                                                  |
| -------- | --------------------------------------------------------------------------------------------------- |
| **목적**   | 제목 프리픽스(예: `PL24016`)로 스레드를 생성·연결한다.                                                                |
| **주 액터** | Thread Classifier                                                                                   |
| **사전조건** | UC-1 완료.                                                                                            |
| **주 흐름** | 1) `subjectprefix` 추출 → 2) 기존 스레드 존재 확인 → 3-a) 없으면 새 Row(`threads` 컬렉션) 생성 / 3-b) 있으면 기존 스레드 ID 반환. |
| **사후조건** | 이메일이 스레드 ID와 매핑.                                                                                    |

---

### UC-3. 참여자 맵 업데이트

| 항목                 | 내용                                                            |
| ------------------ | ------------------------------------------------------------- |
| **목적**             | 각 스레드별 “의장” 및 “멤버” 참여 현황 테이블을 갱신한다.                           |
| **주 액터**           | Participation Tracker                                         |
| **사전조건**           | UC-2 완료, 조직 역할 매핑 테이블(이메일 → 역할)이 존재.                          |
| **주 흐름**           | 1) `sender_address` → 역할 조회 → 2) Row 생성·업데이트(발신자=✅, 미발신자는 ❌). |
| **확장(Extensions)** | 3-e) 미등록 도메인 → “Unknown Participant” 플래그 지정.                  |

---

### UC-4. 회신 마감 모니터링 & 리마인더

| 항목       | 내용                                                                  |
| -------- | ------------------------------------------------------------------- |
| **목적**   | 마감일(D+N 일)을 넘겨 ❌ 상태인 멤버에게 알림 발송.                                    |
| **주 액터** | Deadline Watcher (배치 or 스케줄러)                                       |
| **사전조건** | UC-3 참여자 맵 존재, 스레드별 마감일 정책 설정.                                      |
| **주 흐름** | 1) `receivedDate` 기준 ΔT 계산 → 2) overdue 멤버 필터 → 3) 템플릿 메일/슬랙 알림 발송. |
| **사후조건** | 알림 로그 저장, 회신오류 통계 업데이트.                                             |

---

### UC-5. 주제 완료 판정

| 항목       | 내용                                                                                      |
| -------- | --------------------------------------------------------------------------------------- |
| **목적**   | “모든 필수 멤버가 ✅” or “의장 종결 메일” 수신 시 스레드 상태를 “Closed”로 전환.                                  |
| **주 액터** | Completion Engine                                                                       |
| **주 흐름** | 1) `sender_role == Chair` AND `subject` 패턴 “Final” → 즉시 종결<br>2) Else 전체 참여자 ✅ 체크 → 종결. |
| **후처리**  | `threads.status = closed`, 완료 타임스탬프 기록.                                                 |

---

### UC-6. 이슈·의견 추출(Embedding Semantic Search)

| 항목       | 내용                                                        |
| -------- | --------------------------------------------------------- |
| **목적**   | 본문 임베딩으로 “Risk”, “Objection”, “Agreement” 키워드를 자동 태깅.     |
| **주 액터** | NLP Annotator                                             |
| **주 흐름** | 1) 본문 임베딩 → 사전학습 클러스터/분류기 매핑 → 2) `payload.tags` 필드 업데이트. |
| **확장**   | 태깅 결과를 Prompts 기반 LLM Summary로 알림.                        |

---

### UC-7. 실시간 대시보드 / 검색

| 항목       | 내용                                                             |
| -------- | -------------------------------------------------------------- |
| **목적**   | 스레드 상태, 참여율, 오버듀 현황, 이슈 태그를 시각화 및 질의(Search)한다.                |
| **주 액터** | Chair, Members, PMO, Data Analyst                              |
| **사전조건** | UC-1\~6 데이터 파이프라인 동작.                                          |
| **주 흐름** | 1) Kibana/Superset → Qdrant Hybrid Search(API) → 2) 필터·차트 렌더링. |
| **사후조건** | 사용자 다운로드(Excel/CSV), 상태리포트.                                    |

---

### UC-8. 형식 이탈 감지 및 자동 정정(Smart Lint)

| 항목       | 내용                                             |
| -------- | ---------------------------------------------- |
| **목적**   | 제목 패턴(PREFIX\_XXX) 이탈 메일을 감지하고 회신/수정 안내.       |
| **주 액터** | Subject Linter                                 |
| **주 흐름** | 1) 정규식 검증 → 불일치 건 리스트업 → 2) 발신자에게 템플릿 권고메일 송부. |
| **확장**   | 3-e) 수동 리뷰 큐로 전달해 태그 보정.                       |

---

## 시스템 맵 요약

```
[MDA] → UC-1 Ingress/Embedding → Qdrant
            ↓
       UC-2 Thread Classifier
            ↓
       UC-3 Participation Map ──┐
            ↓                   │
       UC-4 Deadline Watcher ───┤ 알림/슬랙
            ↓                   │
       UC-5 Completion Engine ──┘
            ↓
       UC-6 Issue Tagging
            ↓
       UC-7 Dashboard/Search
            ↓
       UC-8 Lint/Anomaly
```
